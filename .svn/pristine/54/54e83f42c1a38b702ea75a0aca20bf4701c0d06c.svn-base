package presentation.mainui;

import java.awt.Color;
import java.awt.Component;
import java.awt.Cursor;
import java.awt.Dimension;
import java.awt.Font;
import java.awt.FontFormatException;
import java.awt.Graphics;
import java.awt.Insets;
import java.awt.event.MouseEvent;
import java.awt.event.MouseListener;
import java.io.BufferedInputStream;
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.util.ArrayList;

import javax.swing.JButton;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.JScrollBar;
import javax.swing.JScrollPane;
import javax.swing.SwingConstants;
import javax.swing.border.Border;

import presentation_singleGameGUI.singleGameGUI;

import main.Startup;
import message.*;

public class ModeSelectionPanel extends JPanel {

	/**
	 * 
	 */
	private static final long serialVersionUID = 1L;
	private ButtonLabel lblNewLabel, lblNewLabel_1, lblNewLabel_2;
	private JPanel panel_2, panel_3;
	private String friendName;
	private JLabel nameLabel1 = new JLabel("");
	private JLabel nameLabel2 = new JLabel("");

	public ModeSelectionPanel() {
		setSize(847, 381);
		setLayout(null);
		setBackground(new Color(0, 0, 0));

		nameLabel1.setBounds(200, 200, 100, 40);
		nameLabel1.setForeground(Color.white);
		add(nameLabel1);
		
		nameLabel2.setBounds(300, 200, 200, 40);
		nameLabel2.setFont(new Font("微软雅黑",Font.PLAIN,20));
		nameLabel2.setForeground(Color.white);
		add(nameLabel2);
		
		
		final InnerPanel panel = new InnerPanel(new Color(7, 20, 36));
		panel.setBounds(187, 10, 471, 161);
		add(panel);
		panel.setLayout(null);

		JPanel panel_1 = new JPanel();
		panel_1.setSize(150, 155);
		panel_1.setLocation(3, 3);
		panel_1.setLayout(null);
		panel_1.setBackground(new Color(0, 0, 0, 0));
		panel.add(panel_1);

		panel_2 = new InnerPanel(new Color(1, 6, 12));
		panel_2.setLocation(157, 3);
		panel_2.setSize(150, 155);
		panel.add(panel_2);

		panel_3 = new InnerPanel(new Color(1, 6, 12));
		panel_3.setLocation(314, 3);
		panel_3.setSize(150, 155);
		panel_3.setLayout(null);
		panel.add(panel_3);

		lblNewLabel = new ButtonLabel("单机模式");
		lblNewLabel.setBounds(4, 4, 145, 47);
		lblNewLabel.addMouseListener(new MouseListener() {

			@Override
			public void mouseClicked(MouseEvent e) {
				// TODO Auto-generated method stub

			}

			@Override
			public void mousePressed(MouseEvent e) {
				// TODO Auto-generated method stub

			}

			@Override
			public void mouseReleased(MouseEvent e) {
				// TODO Auto-generated method stub
				lblNewLabel.selected = true;
				lblNewLabel_1.selected = false;
				lblNewLabel_2.selected = false;
				panel_2.removeAll();
				final JLabel l = new JLabel("   开始游戏");
				l.setForeground(Color.white);
				l.setFont(new Font("微软雅黑", Font.PLAIN, 14));
				l.setBounds(5, 5, 140, 45);
				l.addMouseListener(new MouseListener() {

					@Override
					public void mouseClicked(MouseEvent e) {
						// TODO Auto-generated method stub

					}

					@Override
					public void mousePressed(MouseEvent e) {
						// TODO Auto-generated method stub

					}

					@Override
					public void mouseReleased(MouseEvent e) {
						// TODO Auto-generated method stub
                       singleGameGUI a= new singleGameGUI();
                       a.singlenamestart(Startup.window.uif.name);
					}

					@Override
					public void mouseEntered(MouseEvent e) {
						// TODO Auto-generated method stub
						setCursor(new Cursor(Cursor.HAND_CURSOR));
						l.setOpaque(true);
						l.setBackground(new Color(35, 82, 66));
						repaint();
					}

					@Override
					public void mouseExited(MouseEvent e) {
						// TODO Auto-generated method stub
						setCursor(new Cursor(Cursor.DEFAULT_CURSOR));
						l.setOpaque(false);
						repaint();
					}

				});
				panel_2.add(l);
				repaint();
			}

			@Override
			public void mouseEntered(MouseEvent e) {
				// TODO Auto-generated method stub
				setCursor(new Cursor(Cursor.HAND_CURSOR));
			}

			@Override
			public void mouseExited(MouseEvent e) {
				// TODO Auto-generated method stub
				setCursor(new Cursor(Cursor.DEFAULT_CURSOR));
			}

		});
		panel_1.add(lblNewLabel);

		lblNewLabel_1 = new ButtonLabel("协作模式");
		lblNewLabel_1.setBounds(4, 56, 145, 47);
		lblNewLabel_1.addMouseListener(new MouseListener() {

			@Override
			public void mouseClicked(MouseEvent e) {
				// TODO Auto-generated method stub
			}

			@Override
			public void mousePressed(MouseEvent e) {
				// TODO Auto-generated method stub

			}

			@Override
			public void mouseReleased(MouseEvent e) {

				// TODO Auto-generated method stub
				lblNewLabel.selected = false;
				lblNewLabel_1.selected = true;
				lblNewLabel_2.selected = false;
				panel_2.removeAll();
				final JLabel l = new JLabel("   邀请协作");
				l.setForeground(Color.white);
				l.setFont(new Font("微软雅黑", Font.PLAIN, 14));
				l.setBounds(5, 5, 140, 45);
				l.addMouseListener(new MouseListener() {

					@Override
					public void mouseClicked(MouseEvent e) {
						// TODO Auto-generated method stub
						/*
						ArrayList<String> data = new ArrayList<String>();
						String[] Data = { "3#2014-03-02", "6#2014-03-03",
								"8#2014-03-04", "3#2014-03-05",
								"10#2014-03-06", "7#2014-03-07", "6#2014-03-08" };
						data.add(Data[0]);
						data.add(Data[1]);
						data.add(Data[2]);
						data.add(Data[3]);
						data.add(Data[4]);
						data.add(Data[5]);
						data.add(Data[6]);
						*/
						ShowOnlineFriendMessage m1 = new ShowOnlineFriendMessage(Startup.window.uif.name);
						Startup.net.sendMessage(m1);
						ArrayList<String> data=((ShowOnlineFriendBackMessage)Startup.net.getMessage(-144)).online_friends;
						
						int height = 0;
						JPanel friendPanel = new JPanel();
						friendPanel.setPreferredSize(new Dimension(130, data
								.size() * 30));
						friendPanel.setLayout(null);
						for (int i = 0; i < data.size(); i++) {
							final JLabel idLabel = new JLabel(data.get(i));
							idLabel.setHorizontalAlignment(SwingConstants.CENTER);
							idLabel.setBounds(0, height,130,30);
							idLabel.setForeground(Color.white);
							height = height + 30;
							idLabel.addMouseListener(new MouseListener() {

								@Override
								public void mouseClicked(MouseEvent e) {
									// TODO Auto-generated method stub
									friendName = idLabel.getText();
									remove(nameLabel1);
									remove(nameLabel2);
									JButton button = new JButton("发出邀请");
									button.setBounds(550, 200, 200, 40);
									Font font = null;
									try {
										font = setFont("迷你简太极",20,0);
										button.setFont(font);
									} catch (FontFormatException e1) {
										// TODO Auto-generated catch block
										e1.printStackTrace();
									} catch (IOException e1) {
										// TODO Auto-generated catch block
										e1.printStackTrace();
									}
									button.setBackground(new Color(126, 234, 239, 122));
									button.setOpaque(false);
									button.setForeground(Color.white);
									button.setBorder(null);
									button.addMouseListener(new MouseListener(){

										@Override
										public void mouseClicked(MouseEvent e) {
											// TODO Auto-generated method stub
											CooperateRequestMessage m1 = new CooperateRequestMessage(Startup.window.uif.name, friendName);
											Startup.net.sendMessage(m1);
										}

										@Override
										public void mousePressed(MouseEvent e) {
											// TODO Auto-generated method stub
											
										}

										@Override
										public void mouseReleased(MouseEvent e) {
											// TODO Auto-generated method stub
											
										}

										@Override
										public void mouseEntered(MouseEvent e) {
											// TODO Auto-generated method stub
											setCursor(new Cursor(Cursor.HAND_CURSOR));
										}

										@Override
										public void mouseExited(MouseEvent e) {
											// TODO Auto-generated method stub
											setCursor(new Cursor(Cursor.DEFAULT_CURSOR));
										}
										
									});
									add(button);
									
									nameLabel1.setText("好友名称：");
									
									nameLabel2.setText(idLabel.getText());
										nameLabel1.setFont(font);
									
									add(nameLabel1);
									add(nameLabel2);
									repaint();
								}

								@Override
								public void mousePressed(MouseEvent e) {
									// TODO Auto-generated method stub

								}

								@Override
								public void mouseReleased(MouseEvent e) {
									// TODO Auto-generated method stub

								}

								@Override
								public void mouseEntered(MouseEvent e) {
									// TODO Auto-generated method stub
									setCursor(new Cursor(Cursor.HAND_CURSOR));
									idLabel.setOpaque(true);
									idLabel.setBackground(new Color(35, 82, 66));
									repaint();
								}

								@Override
								public void mouseExited(MouseEvent e) {
									// TODO Auto-generated method stub
									setCursor(new Cursor(Cursor.DEFAULT_CURSOR));
									idLabel.setOpaque(false);
									repaint();
								}

							});
							friendPanel.add(idLabel);
						}
						friendPanel.setVisible(true);
						friendPanel.setOpaque(false);
						JScrollPane panel7 = new JScrollPane(friendPanel);
						panel7.getViewport().setOpaque(false);// 将JScrollPane设置为透明
						panel7.setOpaque(false);// 将中间的viewport设置为透明
						panel7.setBounds(0, 0, 150, 155);
						JScrollBar bar = panel7.getVerticalScrollBar();
						bar.setBackground(Color.black);

						panel_3.add(panel7);
						repaint();
						Startup.window.mainframe.frame.setVisible(true);
					}

					@Override
					public void mousePressed(MouseEvent e) {
						// TODO Auto-generated method stub

					}

					@Override
					public void mouseReleased(MouseEvent e) {
						// TODO Auto-generated method stub

					}

					@Override
					public void mouseEntered(MouseEvent e) {
						// TODO Auto-generated method stub
						setCursor(new Cursor(Cursor.HAND_CURSOR));
						l.setOpaque(true);
						l.setBackground(new Color(35, 82, 66));
						repaint();
					}

					@Override
					public void mouseExited(MouseEvent e) {
						// TODO Auto-generated method stub
						setCursor(new Cursor(Cursor.DEFAULT_CURSOR));
						l.setOpaque(false);
						repaint();
					}

				});
				panel_2.add(l);
				repaint();
			}

			@Override
			public void mouseEntered(MouseEvent e) {
				// TODO Auto-generated method stub
				setCursor(new Cursor(Cursor.HAND_CURSOR));
			}

			@Override
			public void mouseExited(MouseEvent e) {
				// TODO Auto-generated method stub
				setCursor(new Cursor(Cursor.DEFAULT_CURSOR));
			}

		});
		panel_1.add(lblNewLabel_1);

		lblNewLabel_2 = new ButtonLabel("对战模式");
		lblNewLabel_2.setBounds(4, 108, 145, 47);
		lblNewLabel_2.addMouseListener(new MouseListener() {

			@Override
			public void mouseClicked(MouseEvent e) {
				// TODO Auto-generated method stub

			}

			@Override
			public void mousePressed(MouseEvent e) {
				// TODO Auto-generated method stub

			}

			@Override
			public void mouseReleased(MouseEvent e) {
				// TODO Auto-generated method stub
				lblNewLabel.selected = false;
				lblNewLabel_1.selected = false;
				lblNewLabel_2.selected = true;
				panel_2.removeAll();
				final JLabel l = new JLabel("   邀请PK");
				l.setForeground(Color.white);
				l.setFont(new Font("微软雅黑", Font.PLAIN, 14));
				l.setBounds(5, 5, 140, 45);
				l.addMouseListener(new MouseListener() {

					@Override
					public void mouseClicked(MouseEvent e) {
						// TODO Auto-generated method stub

					}

					@Override
					public void mousePressed(MouseEvent e) {
						// TODO Auto-generated method stub

					}

					@Override
					public void mouseReleased(MouseEvent e) {
						// TODO Auto-generated method stub

					}

					@Override
					public void mouseEntered(MouseEvent e) {
						// TODO Auto-generated method stub
						setCursor(new Cursor(Cursor.HAND_CURSOR));
						l.setOpaque(true);
						l.setBackground(new Color(35, 82, 66));
						repaint();
					}

					@Override
					public void mouseExited(MouseEvent e) {
						// TODO Auto-generated method stub
						setCursor(new Cursor(Cursor.DEFAULT_CURSOR));
						l.setOpaque(false);
						repaint();
					}

				});
				panel_2.add(l);
				repaint();
			}

			@Override
			public void mouseEntered(MouseEvent e) {
				// TODO Auto-generated method stub
				setCursor(new Cursor(Cursor.HAND_CURSOR));
			}

			@Override
			public void mouseExited(MouseEvent e) {
				// TODO Auto-generated method stub
				setCursor(new Cursor(Cursor.DEFAULT_CURSOR));
			}

		});
		panel_1.add(lblNewLabel_2);

	}

	public class InnerPanel extends JPanel {

		Color color;

		/**
		 * 
		 */
		private static final long serialVersionUID = 1L;

		public InnerPanel(Color c) {
			color = c;
			setLayout(null);
			setBorder(new Border() {

				@Override
				public void paintBorder(Component c, Graphics g, int x, int y,
						int width, int height) {
					// TODO Auto-generated method stub
					g.setColor(new Color(58, 69, 87));
					g.drawRoundRect(0, 0, width - 1, height - 1, 5, 5);
				}

				@Override
				public Insets getBorderInsets(Component c) {
					// TODO Auto-generated method stub
					return new Insets(1, 1, 1, 1);
				}

				@Override
				public boolean isBorderOpaque() {
					// TODO Auto-generated method stub
					return true;
				}

			});
		}

		public void paintComponent(Graphics g) {
			g.setColor(color);
			g.fillRoundRect(0, 0, getWidth() - 1, getHeight() - 1, 5, 5);
		}

	}

	private Font setFont(String fileName, int size, int font)
			throws FontFormatException, IOException {
		File file = new File(fileName + ".ttf");
		FileInputStream fi = new FileInputStream(file);
		BufferedInputStream fb = new BufferedInputStream(fi);
		Font nf = Font.createFont(Font.TRUETYPE_FONT, fb);
		switch (font) {
		case (0):
			nf = nf.deriveFont(Font.PLAIN, size);
		case (1):
			nf = nf.deriveFont(Font.BOLD, size);
		case (2):
			nf = nf.deriveFont(Font.ITALIC, size);
		}

		nf = nf.deriveFont(Font.PLAIN, size);

		return nf;
	}

}